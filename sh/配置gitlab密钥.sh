#!/bin/bash
# 配置gitlab密钥
GIT_PRIVATE_KEY=LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcGdJQkFBS0NBUUVBeGtrSU16emxreVpUSVlya2ZFMWd5eUNGNy9VcEQ0Zi83UE9tNVorMmFEaFI3VjN2CkpYOUlCRTZpY3g4MnZQbDhyM3dRNE4yejVsQWVmejlrc0JqU3RvalBCUFRaemtqeWlJdktUR2FMdUE4cG40cnMKZ21tdG1SdkZGSng3Q3NBV0dDclgxK05MVzZQamVvNndoZWxFWkJQa0d6MUdpWnZXRFV4dDVncG5MN0t5SGMzWgpYTkM2T0s3K0d0SkEzMGNHcHZQS21RaG8yTlFuQUhYSjkyalJhZTVId3ppYVJBL29hbmpjakgrYWk3Z2tWbWpICldXYWZ6Zko0SnVaUVd0VGFsZFg5MUhSNytDZ2RQSC9VMWxYZjJxVVlLWElpRnZOWEtxcWNiSHVEcVpiWUgzUXYKTFgra3Z4Q2xYVTFiWGIxM2JNUHJQc2kyaTZ3RmFVd0NiTThZbXdJREFRQUJBb0lCQVFDSXNDdkE5b2ZrQ3BWZwpHQmt1UDBFc2hmME96OWhBWnFaY09CS2pWSmd2L0RNdUNJVWxPanJ4RFN3YlpEY2R5bmJUbWhrZ2luVExuZ3VICitMRjJXNFpXWXJValc0OFNEMk55RWJ1aE0wZTUyR24vRzR1eTB4cmk0eXZXNjVBK2R2QkVOTFNhbEl1TVhzd2YKM21GOXpySmdzdjJhY1lGQXQzYTFzQ3hLV24yTGVOSFdEellwdFY2VFAxcWh5TVFZM0pNTUdtZ1VCUlFyNmFCKwpuUENyYnBPSURncmRIZEJOaE9WZFBFb2J4OTlaT2dMNFpDbmRFcXV3OHZ0WDArTGpvbnhZeFJLNTFnWDhWOU5ICkxBTmlQdTFMQTNWMzYybWxaVllIbGhhRE9PNUtHdllLakppanNnR2tjVExkY3BxOG5CZEFETEpZbFlFNy9VVHYKVXR1NTZ0a3hBb0dCQVBuMjZrdGcydmx3ZlJKY0UvcjBCcVAwYVpadjNtbXF5SW8xSnBjSytwZnQ4YTNIYjRlSApNNHpwNGdLYjgzMGdLZTJ6QkRRWnh2OGpzd0xRTitQbHZKVHpMRElNNk9FdlJlclQ5N0pGd1JmbXErVEdRWVFmCmtkTm9kbkUyUjhVR1ZuZnBMTVlnVXJtUXBoRDNCcnp2OWo4YWJyY1dFUmxkcGhjRzQvSEtqcEFmQW9HQkFNc1MKclNIdVArL2JCK0JXY3hSbFpPeHBYYmlNeGl6U3lFSXB5TGNCeVQ3T3B0UWFpZ3JwRXp6bkVGSlVSQnc4TzVWeQppcHRzaFl2UWh0cXlKMmtBNmJkamNLV1ZFR3FlR2s3NUdWRjdVWjBBWVBabHBPZ3JmdDdLZk0wVml6RkdwSkhSCnNnWWxySE85cGhIODAyVk55cnZvWHJ1R0hPaXV5UWkxSFpReGtMZ0ZBb0dCQVBNenZmbmhIcXliT2RWbktUbDkKdkFoQmdZb1JCZ0VoWFVTN09mU3poZVhVYU5SL3VvL09oK1dPbVl1WVdHdGhvK25WeHowNTUxZk9VQmxvcFRoagpDZnlTTEduMkRZOHJBNGZhL0tEREpZQXZ1d2MzcmY3ekNGcjh4R0NhUTNIN0hKNUdqSDJvYlZTRzNFeWRURHovCjdFS3hZUTladFFGTkVKQk83L0VNOTNCWkFvR0JBTEFmRDRjWkFkeTlveFFmQmduUGNudFRXdFEvUzNUK2ptNUwKbk9lVHBmMVI3d0NQejk5c2k2SExhSzF1cGUrekVaNG96Q3ZHTUFDMXB1K3ZpVnlaVFJvZkpVaUdnc2xsTzczNApic3ZyWHpvQ1pSWHR5OXNNTmlsMWhrMjcvSStOREJmbnZUVjFvUjUwZ2I2aC9wbWlvVXpkV0tQY3lkL0lEMVQ4Cjk1MWFhNEFkQW9HQkFLSGp5c0paTFNOdVhyNzhlR2JmTVlnTnV1WUhxbXU1NTcyeUJjejlDNGNFQ1RBRGMzRVoKWUQ1TURzNjNzQVgvMUlhaUEzTWNZVmdEcjlaL3dpUVJHNHgvQXhsRTlERDVOTHVXZHF0bm9zZGdCZFVIVXZ4cQpsWlhpVEdIQ2xuallpb1o4MVBGK3NWZ0lQUlBQdXZoZEZJKy9UN3JHNUtTU1BYdVVBR29uWm52UAotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
if [ -n "$GIT_PRIVATE_KEY" ]; then
  key_file_path="/root/.ssh/id_rsa"
  config_file_path="/root/.ssh/config"
  echo $GIT_PRIVATE_KEY | base64 -d > $key_file_path
  echo "Host gitlab.oneitfarm.com
  HostName gitlab.oneitfarm.com
  Port 29622" > $config_file_path
  ssh-keyscan -p 29622 gitlab.oneitfarm.com 2>/dev/null > /root/.ssh/known_hosts
  chmod 600 $key_file_path $config_file_path
fi